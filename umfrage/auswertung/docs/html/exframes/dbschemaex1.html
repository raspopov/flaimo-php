<code><font color="#000000">
<font color="#0000CC">&lt;?php<br /></font><font color="#FF9900">/*=======================================================================<br />// File: &nbsp;&nbsp;&nbsp;&nbsp;DBSCHEMAEX1.PHP<br />// Description:&nbsp;&nbsp;&nbsp;&nbsp;Draw a DB schema of the DDDA architecture<br />// Created: &nbsp;&nbsp;&nbsp;&nbsp;2002-08-25<br />// Author:&nbsp;&nbsp;&nbsp;&nbsp;Johan Persson (johanp@aditus.nu)<br />// Ver:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Id: dbschemaex1.php,v 1.1 2002/08/27 20:08:57 aditus Exp $<br />//<br />// License:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This code is released under QPL<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright (C) 2001,2002 Johan Persson<br />// Note:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The actual drawing of the tables are semi-automatically<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but you can easily adjust the individual tables position<br />//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with the 'tblposadj' array. <br />//<br />//========================================================================<br />*/<br /></font><font color="#006600">include&nbsp;</font><font color="#CC0000">"../jpgraph.php"</font><font color="#006600">;<br />include&nbsp;</font><font color="#CC0000">"../jpgraph_canvas.php"</font><font color="#006600">;<br />include&nbsp;</font><font color="#CC0000">"../jpgraph_canvtools.php"</font><font color="#006600">;<br />include&nbsp;</font><font color="#CC0000">"../utils/misc/imgdbschema.inc"</font><font color="#006600">;<br />include&nbsp;</font><font color="#CC0000">"../utils/jpdocgen/jpdb.php"</font><font color="#006600">;<br /><br /><br /></font><font color="#FF9900">// Global callback to format the table header names<br /></font><font color="#006600">function&nbsp;</font><font color="#0000CC">FormatTblName</font><font color="#006600">(</font><font color="#0000CC">$aName</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// We want to replace any specifi references to the<br />&nbsp;&nbsp;&nbsp;&nbsp;// 'JpGraph' project with the generic '&lt;project&gt;'<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#006600">return&nbsp;</font><font color="#0000CC">str_replace</font><font color="#006600">(</font><font color="#CC0000">'JpGraph'</font><font color="#006600">,</font><font color="#CC0000">'&lt;project&gt;'</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$aName</font><font color="#006600">);<br />}<br /><br /></font><font color="#FF9900">// Global callback to format each field name in the table<br /></font><font color="#006600">function&nbsp;</font><font color="#0000CC">FormatFldName</font><font color="#006600">(</font><font color="#0000CC">$aName</font><font color="#006600">,</font><font color="#0000CC">$aTable</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</font><font color="#0000CC">$aName</font><font color="#006600">;<br />}<br /><br /><br />class&nbsp;</font><font color="#0000CC">Driver&nbsp;</font><font color="#006600">{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;</font><font color="#0000CC">$ig</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$img</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$iscale</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$ishape</font><font color="#006600">;<br />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;</font><font color="#0000CC">$iymax</font><font color="#006600">,</font><font color="#0000CC">$ixmax</font><font color="#006600">;<br />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;</font><font color="#0000CC">$iwidth</font><font color="#006600">,</font><font color="#0000CC">$iheight</font><font color="#006600">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</font><font color="#0000CC">Driver</font><font color="#006600">()&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Define Image size and coordinate grid space to work within<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iwidth&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">600</font><font color="#006600">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iheight</font><font color="#006600">=&nbsp;</font><font color="#0000CC">750</font><font color="#006600">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iymax&nbsp;&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">50</font><font color="#006600">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ixmax&nbsp;&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">55</font><font color="#006600">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Setup a basic canvas<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ig&nbsp;</font><font color="#006600">=&nbsp;new&nbsp;</font><font color="#0000CC">CanvasGraph</font><font color="#006600">(</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iwidth</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iheight</font><font color="#006600">,</font><font color="#CC0000">'auto'</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ig</font><font color="#006600">-&gt;</font><font color="#0000CC">img</font><font color="#006600">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Define the scale to be used<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iscale&nbsp;</font><font color="#006600">=&nbsp;new&nbsp;</font><font color="#0000CC">CanvasScale</font><font color="#006600">(</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ig</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iscale</font><font color="#006600">-&gt;</font><font color="#0000CC">Set</font><font color="#006600">(</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ixmax</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iymax</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ishape&nbsp;</font><font color="#006600">=&nbsp;new&nbsp;</font><font color="#0000CC">Shape</font><font color="#006600">(</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ig</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iscale</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// A small frame around the canvas<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ig</font><font color="#006600">-&gt;</font><font color="#0000CC">SetMargin</font><font color="#006600">(</font><font color="#0000CC">2</font><font color="#006600">,</font><font color="#0000CC">3</font><font color="#006600">,</font><font color="#0000CC">2</font><font color="#006600">,</font><font color="#0000CC">3</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ig</font><font color="#006600">-&gt;</font><font color="#0000CC">SetMarginColor</font><font color="#006600">(</font><font color="#CC0000">"teal"</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ig</font><font color="#006600">-&gt;</font><font color="#0000CC">InitFrame</font><font color="#006600">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</font><font color="#0000CC">Run</font><font color="#006600">()&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$leftm</font><font color="#006600">=</font><font color="#0000CC">1.5</font><font color="#006600">;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Left margin (for table schemes) <br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$topm</font><font color="#006600">=</font><font color="#0000CC">5</font><font color="#006600">;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Top margin (for table schemes) <br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tblwidth</font><font color="#006600">=</font><font color="#0000CC">15</font><font color="#006600">;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Individual table width<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tlo</font><font color="#006600">=</font><font color="#0000CC">1</font><font color="#006600">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Offset for top line<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;// Add the background color for the project specific tables<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ishape</font><font color="#006600">-&gt;</font><font color="#0000CC">IndentedRectangle</font><font color="#006600">(</font><font color="#0000CC">$leftm</font><font color="#006600">,</font><font color="#0000CC">$topm</font><font color="#006600">-</font><font color="#0000CC">1</font><font color="#006600">,</font><font color="#0000CC">3</font><font color="#006600">*</font><font color="#0000CC">$tblwidth</font><font color="#006600">+</font><font color="#0000CC">$tlo</font><font color="#006600">+</font><font color="#0000CC">6</font><font color="#006600">,</font><font color="#0000CC">45</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tlo</font><font color="#006600">+</font><font color="#0000CC">2</font><font color="#006600">*</font><font color="#0000CC">$tblwidth</font><font color="#006600">+</font><font color="#0000CC">2</font><font color="#006600">,</font><font color="#0000CC">30</font><font color="#006600">,</font><font color="#0000CC">CORNER_BOTTOMLEFT</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#CC0000">'lightblue'</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Stroke the tables (series of x,y offsets, If =-1 then use the<br />&nbsp;&nbsp;&nbsp;&nbsp;// automtic positioning<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tblposadj</font><font color="#006600">=array(</font><font color="#0000CC">$tlo</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">$tblwidth</font><font color="#006600">+</font><font color="#0000CC">$tlo</font><font color="#006600">+</font><font color="#0000CC">2</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">2</font><font color="#006600">*</font><font color="#0000CC">$tblwidth</font><font color="#006600">+</font><font color="#0000CC">$tlo</font><font color="#006600">+</font><font color="#0000CC">4</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,-</font><font color="#0000CC">1</font><font color="#006600">,</font><font color="#0000CC">16</font><font color="#006600">,-</font><font color="#0000CC">1</font><font color="#006600">,</font><font color="#0000CC">16</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$dbschema&nbsp;</font><font color="#006600">=&nbsp;new&nbsp;</font><font color="#0000CC">ImgDBSchema</font><font color="#006600">(</font><font color="#CC0000">'jpgraph_doc'</font><font color="#006600">,</font><font color="#CC0000">'FormatTblName'</font><font color="#006600">,</font><font color="#CC0000">'FormatFldName'</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$dbschema</font><font color="#006600">-&gt;</font><font color="#0000CC">SetMargin</font><font color="#006600">(</font><font color="#0000CC">$leftm</font><font color="#006600">,</font><font color="#0000CC">$topm</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$dbschema</font><font color="#006600">-&gt;</font><font color="#0000CC">SetTableWidth</font><font color="#006600">(</font><font color="#0000CC">$tblwidth</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$dbschema</font><font color="#006600">-&gt;</font><font color="#0000CC">Stroke</font><font color="#006600">(</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">img</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iscale</font><font color="#006600">,</font><font color="#0000CC">$tblposadj</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt&nbsp;</font><font color="#006600">=&nbsp;new&nbsp;</font><font color="#0000CC">CanvasRectangleText</font><font color="#006600">();<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFillColor</font><font color="#006600">(</font><font color="#CC0000">''</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">SetColor</font><font color="#006600">(</font><font color="#CC0000">''</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFontColor</font><font color="#006600">(</font><font color="#CC0000">'navy'</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Add explanation<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFont</font><font color="#006600">(</font><font color="#0000CC">FF_ARIAL</font><font color="#006600">,</font><font color="#0000CC">FS_NORMAL</font><font color="#006600">,</font><font color="#0000CC">12</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">Set</font><font color="#006600">(</font><font color="#CC0000">'Project specific tables'</font><font color="#006600">,</font><font color="#0000CC">$tblwidth</font><font color="#006600">+</font><font color="#0000CC">$leftm</font><font color="#006600">+</font><font color="#0000CC">3</font><font color="#006600">,</font><font color="#0000CC">16</font><font color="#006600">,</font><font color="#0000CC">15</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">Stroke</font><font color="#006600">(</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">img</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iscale</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Add title<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">SetColor</font><font color="#006600">(</font><font color="#CC0000">''</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFont</font><font color="#006600">(</font><font color="#0000CC">FF_VERDANA</font><font color="#006600">,</font><font color="#0000CC">FS_BOLD</font><font color="#006600">,</font><font color="#0000CC">26</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">Set</font><font color="#006600">(</font><font color="#CC0000">'DDDA - DB Schema'</font><font color="#006600">,</font><font color="#0000CC">9</font><font color="#006600">,</font><font color="#0000CC">0.5</font><font color="#006600">,</font><font color="#0000CC">30</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">Stroke</font><font color="#006600">(</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">img</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iscale</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900">// Add a version and date<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFillColor</font><font color="#006600">(</font><font color="#CC0000">'yellow'</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">SetFont</font><font color="#006600">(</font><font color="#0000CC">FF_FONT1</font><font color="#006600">,</font><font color="#0000CC">FS_NORMAL</font><font color="#006600">,</font><font color="#0000CC">10</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">Set</font><font color="#006600">(</font><font color="#CC0000">"Generated: "</font><font color="#006600">.</font><font color="#0000CC">date</font><font color="#006600">(</font><font color="#CC0000">"ymd H:i"</font><font color="#006600">,</font><font color="#0000CC">time</font><font color="#006600">()),</font><font color="#0000CC">1</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iymax</font><font color="#006600">*</font><font color="#0000CC">0.96</font><font color="#006600">,</font><font color="#0000CC">15</font><font color="#006600">);&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tt</font><font color="#006600">-&gt;</font><font color="#0000CC">Stroke</font><font color="#006600">(</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">img</font><font color="#006600">,</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">iscale</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$this</font><font color="#006600">-&gt;</font><font color="#0000CC">ig</font><font color="#006600">-&gt;</font><font color="#0000CC">Stroke</font><font color="#006600">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></font><font color="#0000CC">$driver&nbsp;</font><font color="#006600">=&nbsp;new&nbsp;</font><font color="#0000CC">Driver</font><font color="#006600">();<br /></font><font color="#0000CC">$driver</font><font color="#006600">-&gt;</font><font color="#0000CC">Run</font><font color="#006600">();<br /><br /></font><font color="#0000CC">?&gt;<br /></font><br /></font>
</code>